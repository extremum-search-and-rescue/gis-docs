### Приложение Traccar Client

Подготовка к использованию
1) Скачать приложение на телефон/планшет

2) Открыть в Telegram диалог с ботом [SASBot](https://t.me/extremum_sasbot) (@extremum_sasbot)  
или открыть бота по QR коду:  
<picture>
    <img src="https://www.stqr.ru/qrcodes/QR-code_url_21_Apr_2023_19-24-30.png"/>
</picture>

3) написать боту команду **/traccar** или выбрать её в меню  
В ответ вы получите ссылку примерно такого содержания: https://layers.extremum.org/v2/webhook/trackers/***/  
в этой ссылке содержится адрес сервера (если отправлять координаты в никуда, то они и будут нигде) и ваш идентификатор. С помощью идентификатора система сможет определять от кого координаты пришли, чьё имя показывать и кому будет отвечать бот

4) Далее вам необходимо открыть приложение (программе необходимо дать все необходимые доступы при запросе) и скопировать полученную ссылку в графу **URL сервера**
5) В самом приложении в пункте **Точность местоположения** выставить параметр **Высокая**
6) В пункте **Частота** указать например **15** (частота отправки/обновления данных на карте и сервере в секундах). Слишком высокая частота будет разряжать устройство многократно быстрее

#### Как пользоваться  
Когда например вы выехали на ПСР или вышли на маршрут. Зайти в приложение и в графе Состояние сервиса передвинуть бегунок. Вы увидите сообщение, что сервис запущен. Сверните приложение (не закрывайте). Вскоре SASbot пришлет вам сообщение примерно такого содержания:  
_Николай, геопозицию вижу, записываю_

Координаты [3], обновлены: 11:48:52  
N 59 59,473, E 30 14,326   
59,99121, 30,23877   
N 59 59' 28'', E 30 14' 20''   
Точность: 140 м.


И спустя короткое время ваша геопозиция будет отображаться на ресурсе https://gis.extremum.org/ (галочка на слое Трекеры). Вокруг флажка трекера будет окружность, которой обозначается точность определения координат, если круг огромный, то сначала надо проверить параметр **Точность** и выставить **Высокая**, либо заняться настройкой телефона, например, выключить

- Если при включении трекера вам долгое время не приходит сообщение с координатами от SASbot, это не страшно и с высокой вероятностью всё работает нормально. Вы можете зайти на https://gis.extremum.org/, установить галочку на отображении трекеров, найти на карте где вы примерно находитесь и посмотреть видно ли ваше местоположение. Так же возможно нет нормального сотового покрытия или интернета. Это тоже не проблема, так как приложение накапливает данные и как только появится сеть они будут отправлены.
- Приложение довольно стабильно работает, но самое главное благодаря этому клиенту перемещения спасателей online на карте отображаются ровными треками, а не кривыми хаотичными линиями.
- Имя трекера берётся из Telegram и в графе имени (поле фамилия можно оставить пустым) следует написать какое вам необходимо.
- Данные отображаются на карте 24 часа. Новый сегмент пишется если трекер выключен/неактивен один час. При этом трекер может дослать данные за тот час и разорванная линия востановится,
- После выхода с маршрута/возвращения домой не забывайте выключать трекер
- Для корректного отображения времени последней активности, необходима установка правильного времени на устройстве, либо автоматическая синхронизация с временем оператора. Система не принимает данные от трекеров, которые считают что они далеко в будущем - не оставлять же их на карте навечно?

#### Рекомендации для Android  
Желательно зайти в: **Настройки** > **Питание и производительность** > **Контроль активности** > **Traccar** и выбрать **Нет ограничений**. Без этого возможно отключение фоновой работы трекера через определенное время на некоторых устройствах. Если на вашем устройстве такой настройки нет, то помните на Android настройки на разных устройствах не только имеют разные названия, но и зачастую перемещаются по разделам компаниями производителями при обновлениях, поэтому вам нужно найти все возможные исключения энергосбережения и разрешить Traccar работать без ограничений. 
При использовании в качестве трекера отдельного устройства, установите в настройках режим мобильной сети "Только 2G", что сильно сэкономит заряд. Также включите определение местоположения только по спутникам GPS (доступно только на аппаратах с Android до версии 8.1).
## Android

<picture>
<img src="https://www.stqr.ru/qrcodes/QR-code_url_21_Apr_2023_18-11-7.png"/>
</picture>

[Скачать](https://play.google.com/store/apps/details?id=org.traccar.client) для Android

## iOS
<picture>
<img src="https://www.stqr.ru/qrcodes/QR-code_url_21_Apr_2023_18-12-10.png"/>
</picture>

[Скачать](https://apps.apple.com/us/app/traccar-client/id843156974) для iPhone/iPad


Если вы долгое время (от нескольких недель до месяцев) не использовали приложение, а затем при включении трекера бот не отвечает некоторое время, то причины могут быть следующие:
1. ваш трекер _досылает накопленные данные_, которые были собраны прошлый раз, но не успели тогда отправиться. Система их игнорирует потому что они сильно устарели. Когда начнутся новые данные система их примет как обычно. Если вы после возникновения проблемы уже добрались до чтения справки, а бот всё ещё не отвечает, то причина скорее всего не в этом.
2. вы случайно или сознательно _заблокировали бота_. Он не может вам ответить. Проверьте, что вы можете написать боту любое текстовое сообщение или отправить команду.
3. У давно не используемого приложения система отобрала разрешения. Когда вы зайдёте в Traccar Client он запросит разрешения заново
4. Ссылку вы могли получить с какой-нибудь старой учётной записи и именно туда бот и пытается отвечать

Если предыдущее проверено, но бот всё равно не реагирует, то нажмите на **Статус** (англ. **Status**) в верхнем правом углу приложения, в списке событий найдите строчку **Обновление местоположения** (англ. **Location update**). Это событие означает что **а)** местоположение было определено **б)** местоположение было успешно оправлено на сервер. Если в списке только ошибки отправки местоположения, то ваш телефон не может отправить своё местоположение, например, из-за направильных данных в параметре **URL сервера**.


### Ещё почитать:
- Инструкция и обсуждение [«Трекер клиент Traccar»](https://forum.extremum.org/viewtopic.php?f=6&t=20178) на форуме ПСО Экстремум  
- Отправка координат через [телеграм бота](/telegrambot-onlinetracking.md) (старый способ, работает плохо)
- Отправка координат через платное приложение для Android [OsmAnd+](/onlinetracking-osmand.md)